rgName="ch07-rg"
namespaceName="cookbookdemoorsb"
funcStorageAccountName="cookbookordemostorage"
functionAppName="communicationcookdemofunc"

az storage account create --name $funcStorageAccountName --resource-group $rgName --sku Standard_LRS


functionAppName="cookbookordemofuncapp"

az functionapp create --resource-group $rgName --name $functionAppName --storage-account $funcStorageAccountName --functions-version 4 --https-only true --consumption-plan-location eastus


namespaceName="cookbookdemoorsb"

az servicebus namespace create --resource-group $rgName --name $namespaceName --sku Standard

az servicebus queue create --resource-group $rgName --namespace-name $namespaceName --name ordersqueue

serviceBusConnectionString=$(az servicebus namespace authorization-rule keys list --resource-group $rgName --namespace-name $namespaceName --name RootManageSharedAccessKey --query primaryConnectionString --output tsv)

az functionapp config appsettings set --name $functionAppName --resource-group $rgName --settings "ServiceBusConnection1=$serviceBusConnectionString"

az functionapp deployment source config-zip --resource-group $rgName --name $functionAppName --src deploymentPackage.zip

https://communicationcookdemofunc.azurewebsites.net/api/Sender?code=c_8JjB095SPN-15ErcnPQE8aB2Vtj8nhXYa7kKAgLSk9AzFur5WxIA==&kind=cheese&count=2


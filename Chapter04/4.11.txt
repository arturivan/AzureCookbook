RG_NAME="rg-4.11"
SQL_SERVER_NAME="sqlserver25512"
SQL_ADMIN_USER="rezaadmin"
SQL_ADMIN_PASSWORD="Password$1244"

az sql server create --resource-group $RG_NAME --name $SQL_SERVER_NAME --admin-user $SQL_ADMIN_USER --admin-password $SQL_ADMIN_PASSWORD

az sql db create --resource-group $RG_NAME --server $SQL_SERVER_NAME --name db01 --compute-model Serverless --edition GeneralPurpose --family Gen5 --auto-pause-delay 60 --min-capacity 1 --capacity 2

VNET_NAME="vnetsqlfitest"

az network vnet create --resource-group $RG_NAME --name $VNET_NAME --address-prefix 10.0.0.0/16 --subnet-name Subnet01 --subnet-prefix 10.0.0.0/26

SUBNET_ID=$(az network vnet show --resource-group $RG_NAME --name $VNET_NAME --query id -o tsv)"/subnets/Subnet01"

az network vnet subnet update --resource-group $RG_NAME --name Subnet01 --vnet-name $VNET_NAME --service-endpoints Microsoft.Sql

az sql server vnet-rule create --resource-group $RG_NAME --server $SQL_SERVER_NAME --name allowTrustedSubnet --vnet-name $VNET_NAME --subnet Subnet01

az mysql server vnet-rule list --resource-group $RG_NAME --server $SQL_SERVER_NAME



